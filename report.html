<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Strathmore University - Report Lost Item</title>
    <link rel="stylesheet" href="CSS/report.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-4Q6Gf2aSP4eDXB8Miphtr37CMZZQ5oXLH2yaXMJ2w8e2ZtHTl7GptT4jmndRuHDT" crossorigin="anonymous">
    
    
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Report Lost Item</h1>
            <p>Strathmore University Lost & Found System</p>
        </div>
        
        <div class="report-form">
            <form id="lostItemForm">
                <div class="form-group">
                    <label for="item_name">Item Name*</label>
                    <input type="text" id="item_name" name="item_name" required>
                </div>
                
                <div class="form-group">
                    <label for="category">Category*</label>
                    <select id="category" name="category" required>
                        <option value="">Select category</option>
                        <option value="electronics">Electronics</option>
                        <option value="documents">Documents</option>
                        <option value="clothing">Clothing</option>
                        <option value="accessories">Accessories</option>
                        <option value="other">Other</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="description">Description*</label>
                    <textarea id="description" name="description" required></textarea>
                </div>
                
                <div class="form-group">
                    <label for="location">Location Lost*</label>
                    <input type="text" id="location" name="location" required>
                </div>
                
                <div class="form-group">
                    <label for="date_lost">Date Lost*</label>
                    <input type="date" id="date_lost" name="date_lost" required>
                </div>
                
                <div class="form-group">
                    <label for="image_url">Image URL (Optional)</label>
                    <input type="url" id="image_url" name="image_url" placeholder="https://example.com/image.jpg">
                    <img id="image_preview" class="image-preview" alt="Image preview">
                </div>
                
                <div class="form-group">
                    <label for="reporter_name">Your Name*</label>
                    <input type="text" id="reporter_name" name="reporter_name" required>
                </div>
                
                <div class="form-group">
                    <label for="reporter_email">Your Email*</label>
                    <input type="email" id="reporter_email" name="reporter_email" required placeholder="username@strathmore.edu">
                </div>
                
                <button type="submit" class="btn">Report Lost Item</button>
            </form>
            
            <div id="matchResult" class="match-result">
                <h3>Matching Result</h3>
                <div id="matchContent"></div>
            </div>
        </div>
    </div>

    <script>
        // Image preview functionality
        document.getElementById('image_url').addEventListener('input', function() {
            const preview = document.getElementById('image_preview');
            if (this.value) {
                preview.src = this.value;
                preview.style.display = 'block';
            } else {
                preview.style.display = 'none';
            }
        });

        // Form submission
        document.getElementById('lostItemForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            // Collect form data
            const formData = {
                item_name: document.getElementById('item_name').value,
                category: document.getElementById('category').value,
                description: document.getElementById('description').value,
                location: document.getElementById('location').value,
                date_lost: document.getElementById('date_lost').value,
                image_url: document.getElementById('image_url').value,
                reporter_name: document.getElementById('reporter_name').value,
                reporter_email: document.getElementById('reporter_email').value,
                status: 'lost',
                date_reported: new Date().toISOString().split('T')[0]
            };
            
            // In a real application, you would send this to your backend
            console.log('Form data:', formData);
            
            // Simulate saving to database and checking for matches
            saveLostItem(formData);
            
            // For demo purposes, we'll simulate a match
            simulateMatchCheck(formData);
        });
        
        function saveLostItem(item) {
            // In a real app, this would be an AJAX call to your backend
            console.log('Saving to database:', item);
            // Example: fetch('/api/lost-items', { method: 'POST', body: JSON.stringify(item) })
        }
        
        function simulateMatchCheck(lostItem) {
            const matchResult = document.getElementById('matchResult');
            const matchContent = document.getElementById('matchContent');
            
            // This is a simulation - in a real app you would query your database
            const potentialMatches = [
                {
                    id: 101,
                    item_name: "MacBook Pro",
                    category: "electronics",
                    description: "Space gray 13-inch MacBook Pro with Touch Bar",
                    location_found: "Library",
                    date_found: "2023-11-15",
                    image_url: "https://example.com/macbook.jpg",
                    status: "found"
                },
                {
                    id: 102,
                    item_name: "Black Wallet",
                    category: "accessories",
                    description: "Black leather wallet with student ID inside",
                    location_found: "Cafeteria",
                    date_found: "2023-11-18",
                    image_url: "https://example.com/wallet.jpg",
                    status: "found"
                }
            ];
            
            // Simple matching logic (in real app this would be more sophisticated)
            const matches = potentialMatches.filter(item => 
                item.category === lostItem.category && 
                item.location_found.toLowerCase() === lostItem.location.toLowerCase() &&
                new Date(item.date_found) >= new Date(lostItem.date_lost)
            );
            
            if (matches.length > 0) {
                matchResult.className = 'match-result match-found';
                matchResult.style.display = 'block';
                matchContent.innerHTML = `
                    <p>We found ${matches.length} potential match(es) for your lost item!</p>
                    ${matches.map(item => `
                        <div class="matched-item">
                            <img src="${item.image_url || 'https://via.placeholder.com/100?text=No+Image'}" alt="${item.item_name}">
                            <div>
                                <h4>${item.item_name}</h4>
                                <p><strong>Found:</strong> ${item.date_found} at ${item.location_found}</p>
                                <p>${item.description}</p>
                                <button class="btn" onclick="claimItem(${item.id})">Claim This Item</button>
                            </div>
                        </div>
                    `).join('')}
                `;
            } else {
                matchResult.className = 'match-result match-not-found';
                matchResult.style.display = 'block';
                matchContent.innerHTML = `
                    <p>No matches found in our database yet.</p>
                    <p>Your item has been reported and will appear on the security guard's dashboard.</p>
                    <p>We'll notify you if your item is found.</p>
                `;
            }
        }
        
        function claimItem(itemId) {
            // In a real app, this would mark the item as claimed in the database
            alert(`Item ${itemId} claim request sent to security. Please visit the security office with your ID.`);
        }
    </script>
</body>
</html>